#!/usr/bin/env bash
# Display DNS record info for specified subdomains of a domain

function display_record() {
  local domain=$1
  local subdomain=$2
  local full_domain="${subdomain}.${domain}"

  # Query DNS records (A or CNAME) using dig, get concise ANSWER SECTION
  local answer=$(dig +nocmd "$full_domain" A +noall +answer)
  
  if [[ -z $answer ]]; then
    echo "No DNS record found for subdomain $subdomain"
    return
  fi

  # Extract record type and destination
  local record_type=$(echo "$answer" | awk '{print $4}')
  local destination=$(echo "$answer" | awk '{print $5}')
  
  echo "The subdomain $subdomain is a $record_type record and points to $destination"
}

domain=$1
subdomain=$2

if [[ -z $domain ]]; then
  echo "Usage: $0 <domain> [subdomain]"
  exit 1
fi

if [[ -z $subdomain ]]; then
  for sd in www lb-01 web-01 web-02; do
    display_record "$domain" "$sd"
  done
else
  display_record "$domain" "$subdomain"
fi
